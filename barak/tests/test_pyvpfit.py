from ..pyvpfit import *

import sys
if sys.version > '3':
    from io import StringIO
    basestring = str
else:
    from cStringIO import StringIO

f26string = """\
%% pc0058.txt       1   3860.2790   3860.6060 vsig=2.83  !  0.000    14 2013/01/29
%% pc0058.txt       1   3902.7320   3904.2560 vsig=2.83  !  0.001    64   2
%% pc0058.txt       1   3928.0210   3936.7740 vsig=2.83  !  0.000   365   3
%% pc0058.txt       1   4077.3970   4077.8260 vsig=2.83  !  0.002    18   4
%% pc0058.txt       1   4317.1530   4317.5360 vsig=2.83  !  0.001    14   5
%% pc0058_HIRES.txt     1   5404.9460   5405.5600 vsig=2.83  !  0.818    15   6
%% pc0058.txt       1   5999.9250   6000.5520 vsig=2.83  !  0.936    17   7
%% pc0058.txt       1   6026.0680   6026.6980 vsig=2.83  !  0.827    17   8
%% pc0058.txt       1   9045.7720   9047.1260 vsig=2.83  !  0.265    24   9
%% pc0058.txt       1   9068.9550   9070.3720 vsig=2.83  !  0.735    25  10
! Stats:   2     2.2613959  573  545  0.000  0        
 SiIII    2.2348999099aa  0.0000151848     4.78872ba    0.29048  11.641467    0.130349  0 [   0.000   0.000 0.000E+00 0.000E+00
 SiIII    2.2351352917ab  0.0000017209     8.16775bb    0.31374  13.029179    0.067589  0 [   0.000   0.000 0.000E+00 0.000E+00
 SiIII    2.2353755967ac  0.0000297479    22.23979bc    3.69386  12.786722    0.068846  0 [   0.000   0.000 0.000E+00 0.000E+00
 SiIII    2.2357746666ad  0.0000081755     4.84836bd    1.48842  11.983359    0.081416  0 [   0.000   0.000 0.000E+00 0.000E+00
 SiII     2.2351352917AB  0.0000000000     8.16775BB    0.00000  12.613356    0.022349  0 ! 
 H I      2.2348999099AA  0.0000000000    25.00000IA    0.00000  14.000000JA  0.000000  0 ! 
 H I      2.2351352917AB  0.0000000000    25.00000IB    0.00000  14.000000JB  0.000000  0 ! 
 H I      2.2353755967AC  0.0000000000    25.00000IC    0.00000  14.000000JC  0.000000  0 ! 
 H I      2.2357746666AD  0.0000000000    25.00000ID    0.00000  14.000000JD  0.000000  0 ! 
 MgII     2.2348999099AA  0.0000000000     5.14770BA    0.00000  11.387335    0.154114  0 ! 
 MgII     2.2351352917AB  0.0000000000     8.78003BB    0.00000  12.689159    0.017238  0 ! 
 AlII     2.2351352917AB  0.0000000000     8.33317BB    0.00000  11.889133    0.131066  0 ! 
 AlIII    2.2351352917AB  0.0000000000     8.33317BB    0.00000  11.928856    0.051359  0 ! 
 C II     2.2351352917AB  0.0000000000     7.32270BA    0.00000  13.683541    0.019274  0 ! 
 H I      2.2319254895    0.0000551534    64.63339      9.37614  13.350515    0.050714  0 ! 
 H I      2.2328506310    0.0000111795    25.35402      1.70431  13.399048    0.035701  0 ! 
 H I      2.2336043359AF  0.0000000000    25.00000IG    0.00000  14.100000JF  0.000000  0 ! 
 H I      2.2339773227AE  0.0000000000    25.00000IF    0.00000  14.500000JE  0.000000  0 ! 
 H I      2.2346742768    0.0000353981    25.00000IH    0.00000  14.500000JG  0.000000  0 ! 
 H I      2.2364968161    0.0000283810    73.73363      2.26268  14.342838    0.017187  0 ! 
"""

def test_readf26():
    global vp
    vp = readf26(StringIO(f26string))

def test_calc_v90():
    assert np.allclose(calc_v90(vp), 381.5)

